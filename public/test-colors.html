<!DOCTYPE html>
<html>
<head>
    <title>GeoTIFF Color Scale Test</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #fff; }
        .layer-test { margin: 20px 0; padding: 20px; background: #2a2a2a; border-radius: 8px; }
        .color-strip { display: flex; height: 60px; margin: 10px 0; border: 1px solid #444; }
        .color-sample { flex: 1; display: flex; align-items: center; justify-content: center; font-size: 10px; }
        h2 { color: #4CAF50; margin-top: 0; }
        .info { color: #888; font-size: 12px; }
    </style>
</head>
<body>
    <h1>üé® GeoTIFF Color Scale Visualization</h1>
    <p class="info">This page tests if each layer uses different colors. If all strips look identical, there's a color scale bug.</p>

    <div class="layer-test">
        <h2>üå°Ô∏è LST Layer (Blue ‚Üí Red Heatmap)</h2>
        <div class="info">Data range: -0.97¬∞C to 48.89¬∞C</div>
        <div class="color-strip" id="lst-strip"></div>
    </div>

    <div class="layer-test">
        <h2>üî• UHI Layer (Green/Yellow/Red Discrete)</h2>
        <div class="info">Data range: 1 to 3 (discrete classes)</div>
        <div class="color-strip" id="uhi-strip"></div>
    </div>

    <div class="layer-test">
        <h2>üåø NDVI Layer (Brown ‚Üí Green Vegetation)</h2>
        <div class="info">Data range: -0.08 to 0.50</div>
        <div class="color-strip" id="ndvi-strip"></div>
    </div>

    <div class="layer-test">
        <h2>üèóÔ∏è NDBI Layer (Grey ‚Üí Yellow Built-up)</h2>
        <div class="info">Data range: -0.32 to 0.24</div>
        <div class="color-strip" id="ndbi-strip"></div>
    </div>

    <script>
        // LST Color Scale (Blue to Red)
        function createLSTColorScale(min, max) {
            return (value) => {
                const normalized = (value - min) / (max - min);
                const clamped = Math.max(0, Math.min(1, normalized));
                const r = Math.round(255 * clamped);
                const g = Math.round(255 * (1 - Math.abs(clamped - 0.5) * 2));
                const b = Math.round(255 * (1 - clamped));
                return `rgb(${r}, ${g}, ${b})`;
            };
        }

        // UHI Color Scale (Discrete)
        function uhiColorScale(value) {
            if (value <= 1.33) return '#22c55e'; // Green
            if (value <= 2.66) return '#eab308'; // Yellow
            return '#ef4444'; // Red
        }

        // NDVI Color Scale (Brown to Green)
        function createNDVIColorScale(min, max) {
            return (value) => {
                const normalized = (value - min) / (max - min);
                const clamped = Math.max(0, Math.min(1, normalized));
                if (clamped < 0.25) return '#8b4513';
                if (clamped < 0.5) return '#daa520';
                if (clamped < 0.75) return '#9acd32';
                return '#228b22';
            };
        }

        // NDBI Color Scale (Grey to Yellow)
        function createNDBIColorScale(min, max) {
            return (value) => {
                const normalized = (value - min) / (max - min);
                const clamped = Math.max(0, Math.min(1, normalized));
                const r = Math.round(150 + 105 * clamped);
                const g = Math.round(150 + 105 * clamped);
                const b = Math.round(150 * (1 - clamped));
                return `rgb(${r}, ${g}, ${b})`;
            };
        }

        // Render color strips
        function renderColorStrip(containerId, colorFunc, min, max, steps = 20) {
            const container = document.getElementById(containerId);
            for (let i = 0; i < steps; i++) {
                const value = min + (max - min) * (i / (steps - 1));
                const color = colorFunc(value);
                const div = document.createElement('div');
                div.className = 'color-sample';
                div.style.backgroundColor = color;
                div.title = `Value: ${value.toFixed(2)}\nColor: ${color}`;
                container.appendChild(div);
            }
        }

        // Generate strips
        const lstScale = createLSTColorScale(-0.97, 48.89);
        renderColorStrip('lst-strip', lstScale, -0.97, 48.89);

        renderColorStrip('uhi-strip', uhiColorScale, 1, 3, 3);

        const ndviScale = createNDVIColorScale(-0.08, 0.50);
        renderColorStrip('ndvi-strip', ndviScale, -0.08, 0.50);

        const ndbiScale = createNDBIColorScale(-0.32, 0.24);
        renderColorStrip('ndbi-strip', ndbiScale, -0.32, 0.24);

        console.log('‚úÖ Color scale test rendered');
        console.log('LST sample colors:', {
            low: lstScale(-0.97),
            mid: lstScale(24),
            high: lstScale(48.89)
        });
        console.log('NDVI sample colors:', {
            low: ndviScale(-0.08),
            mid: ndviScale(0.21),
            high: ndviScale(0.50)
        });
        console.log('NDBI sample colors:', {
            low: ndbiScale(-0.32),
            mid: ndbiScale(-0.04),
            high: ndbiScale(0.24)
        });
    </script>
</body>
</html>
